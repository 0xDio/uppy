#!/usr/bin/env bash
set -o pipefail
set -o errexit
set -o nounset
set -o xtrace

# Set magic variables for current file & dir
__dir="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
__file="${__dir}/$(basename "${BASH_SOURCE[0]}")"
__base="$(basename ${__file} .sh)"

# Move into a known directory
DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
cd ${DIR}/..

npm run test:phantom
result=${?}
if [ "$result" = 0 ]; then
  if [ "${CI}" = "true" ] && [ "${TRAVIS_PULL_REQUEST}" = "false" ]; then
    npm run zuul-test
    result=$?
  else
    echo "Skipping zuul-test as this is not a master CI branch test run"
  fi
fi

exit ${result}
